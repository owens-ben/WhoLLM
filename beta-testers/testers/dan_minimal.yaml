# Beta Tester: Dan
# Setup: Minimal smart home, few sensors
# Focus: Edge cases, fallback behavior, graceful degradation

profile:
  name: "Dan"
  description: "Minimal smart home setup - tests fallback behavior"
  focus: "edge_cases_fallbacks"

home_config:
  rooms:
    - living_room
    - bedroom
    - bathroom
  
  persons:
    - name: "Dan"
  
  pets: []
  
  entities:
    living_room:
      - entity_id: "light.living_room"
        hint_type: "light"
    bedroom:
      - entity_id: "light.bedroom"
        hint_type: "light"
    bathroom:
      - entity_id: "light.bathroom"
        hint_type: "light"
    # Note: No motion sensors, no media players, no cameras
  
  person_devices:
    Dan: []  # No device trackers configured!

whollm_config:
  provider: "ollama"
  model: "qwen2.5:3b"
  poll_interval: 30

test_scenarios:
  - name: "Single light indicator"
    description: "Only one light on - should still make prediction"
    steps:
      - set: "light.living_room=on, light.bedroom=off, light.bathroom=off"
        wait: 30
    expected:
      dan_room: "living_room"
      min_confidence: 0.2  # Low confidence expected
      max_confidence: 0.5  # Should not be overly confident

  - name: "No signals at all"
    description: "All lights off - tests unknown handling"
    steps:
      - set: "light.living_room=off, light.bedroom=off, light.bathroom=off"
        wait: 30
    expected:
      dan_room: "unknown"
      confidence: 0.0

  - name: "Multiple lights ambiguous"
    description: "Multiple lights on - tests conflict resolution"
    steps:
      - set: "light.living_room=on, light.bedroom=on, light.bathroom=off"
        wait: 30
    expected:
      # Should pick one, doesn't matter which
      dan_room_valid: ["living_room", "bedroom"]
      max_confidence: 0.5  # Should not be confident with ambiguity

  - name: "Habit learning over time"
    description: "After repeated observations, confidence should increase"
    steps:
      # Simulate repeated bedroom observations at night
      - set: "light.bedroom=on"
        repeat: 5
        wait: 30
    expected:
      # Eventually habits should help
      dan_room: "bedroom"

  - name: "LLM fallback when sensors fail"
    description: "Tests LLM reasoning when sensor data is minimal"
    steps:
      - set: "light.living_room=on"
        wait: 30
    expected:
      # LLM should provide some prediction
      dan_room: "living_room"

success_criteria:
  pass_rate: 0.5  # Lower threshold for edge cases
  avg_confidence: 0.2  # Low confidence expected with minimal sensors
  no_crashes: true  # Most important: system should not crash
